$(document).on("ready",function(){function o(){n=$(".game");i=$("<span class='game-button'>NEW GAME<\/span>");i.on("click",s);n.append(i)}function s(){i.remove();var t=$("<input type='text' id='txtUsername' name='txtUsername' class='game-input' placeholder='Username' />"),u=$("<select id='cboDifficulty' name='cboDifficulty' class='game-input' />").append($("<option value=1>Easy<\/option>"),$("<option value=2>Normal<\/option>"),$("<option value=3>Hard<\/option>")),r=$("<span class='game-button'>START GAME<\/span>"),f=$("<div class='message'> <\/div>");r.on("click",e);t.on("keydown",function(n){console.log(n);13===n.keyCode&&e(n)});n.append(t);n.append(u);n.append(r);n.append(f)}function e(){var i=$("#txtUsername").val(),r=$("#cboDifficulty").val();if(f=$("#cboDifficulty option:selected").text(),$(".message").empty(),!i){$(".message").html($("<span>Username required<\/span>"));return}n.empty();$.ajax({url:"/api/NewGame",data:{username:i,difficulty:r},success:function(n){t=n.user;u(n)}})}function h(i){var f=$("<div class='controls' />"),e;switch(i.fullMap.currentAction){case 1:case 2:e=$("<span class='game-button'>ATTACK<\/span>");e.on("click",function(){$.ajax({url:"/api/Attack",method:"POST",data:{user:t},success:function(i){n.empty();t=i.user;u(i)}})});break;case 3:return f;case 4:return f}var o=$("<span class='game-button'>NORTH<\/span>"),s=$("<span class='game-button'>WEST<\/span>"),h=$("<span class='game-button'>EAST<\/span>"),c=$("<span class='game-button'>SOUTH<\/span>");o.on("click",function(){r("N")});s.on("click",function(){r("W")});h.on("click",function(){r("E")});c.on("click",function(){r("S")});return e?f.append($("<div />").append(e)):(f.append(o),f.append(s),f.append(h),f.append(c)),f}function c(n){var t=$("<div class='info' />"),i;t.append($("<span>Username: "+n.fullMap.currentPlayer.username+"<\/span>"));t.append($("<span>Lives: "+n.fullMap.currentPlayer.lives+"<\/span>"));t.append($("<span>Score: "+n.fullMap.currentPlayer.score+"<\/span>"));i="Walk";switch(n.fullMap.currentAction){case 1:i="Attack monster";break;case 2:i="Attack The boss";break;case 3:return t.append($("<span>GAME OVER<\/span>")),t;case 4:return t.append($("<span>YOU WON<\/span>")),t}return t.append($("<span>Action: "+i+"<\/span>")),n.fullMap.currentMonster&&t.append($("<span>Monster lives: "+n.fullMap.currentMonster.lives+"<\/span>")),t}function r(i){$.ajax({url:"/api/Move",method:"POST",data:{user:t,direction:i},success:function(i){n.empty();t=i.user;u(i)}})}function u(t){var r=t.map,i=$("<div class='map "+f.toLowerCase()+"' />"),u=r.split("\r\n");u.forEach(function(n){n.split("").forEach(function(n){switch(n){case"P":i.append($("<div class='player' />"));break;case"B":i.append($("<div class='boss' />"));break;case"M":i.append($("<div class='monster' />"));break;case"H":i.append($("<div class='healing' />"));break;case"T":i.append($("<div class='toxic' />"));break;case"V":i.append($("<div class='visited' />"));break;case" ":i.append($("<div class='empty' />"))}})});n.append(c(t));n.append(i);n.append(h(t))}var n,i,f,t;o()});